<?php

class Page extends CI_Controller {
    
    public function __construct() {
        parent::__construct();
        $this->load->model('page_model');
    }
    
    public function index()
    {
        $this->load->view('admin/page/index');
    }
    
    public function display()
    {
        $pages = $this->page_model->fetch();
        $data = array('pages' => $pages);
        $this->load->view('admin/page/display/index', $data);
    }
    
    public function insert()
    {
        if(isset($_POST['add_page'])) {
            $page_data= array();
            $page_data['title'] = xss_clean($_POST['title']);
            $page_data['content'] = xss_clean($_POST['content']);
            $page_id = $this->page_model->create($page_data);
            redirect("admin/page/edit/" . $page_id);
        }
        $this->load->view('admin/page/insert/index');
    }
    
    public function edit($page_id) {
        if (isset($_POST['update'])) {
            $d_petdata = array();
            $d_petdata['title'] = xss_clean($_POST['title']);
            $d_petdata['content'] = xss_clean($_POST['content']);

            $this->page_model->update($d_petdata, $page_id);
        }
        
        $db_page = $this->page_model->find_by_id($page_id);
        $this->load->view('admin/page/edit/index', array('db_page' => $db_page));
    }
    
    public function delete($petID) {
        //confirmation
        if (isset($_POST['confirm']) && $_POST['confirm'] == 'yes') {
            $this->Page_model->delete($petID);
            redirect('admin/page/display/');
        } else {
            $pet = $this->Page_model->find_by_id($petID);
            $vw_displaydata = array('pet' => $pet);
            $this->load->view('admin/page/delete/index', $vw_displaydata);
        }
    }
}